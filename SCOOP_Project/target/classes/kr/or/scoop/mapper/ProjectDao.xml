<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.scoop.dao.ProjectDao">
<insert id="insertPJT" parameterType="kr.or.scoop.dto.TeamPjt" >
 insert into Teampjt (tseq,email,pname,pcontent,ptime,istpalarm,ischarge)
  values (tseq_teampjt_seq.nextval,#{email},#{pname},#{pcontent},sysdate,#{istpalarm},#{ischarge})
</insert>
<insert id="insertPJT2">
 insert into tpmember (email,tseq,pjuserrank)
  values (#{param1},#{param2},100)
</insert>
<resultMap type="kr.or.scoop.dto.Tissue" id="Tissue">
	<result column="tiseq" property="tiseq"/>
	<result column="tseq" property="tseq"/>
	<result column="email" property="email"/>
	<result column="tititle" property="tititle"/>
	<result column="ticontent" property="ticontent"/>
	<result column="tistart" property="tistart"/>
	<result column="tiend" property="tiend"/>
	<result column="isprocess" property="isprocess"/>
	<result column="tfilename" property="tfilename"/>
	<result column="tfilesize" property="tfilesize"/>
	<result column="istbook" property="istbook"/>
	<result column="issee" property="issee"/>
	<result column="tidate" property="tidate"/>
</resultMap>
<resultMap type="kr.or.scoop.dto.TeamPjt" id="TeamPjt">
	<result column="tseq" property="tseq"/>
	<result column="email" property="email"/>
	<result column="pname" property="pname"/>
	<result column="pcontent" property="pcontent"/>
	<result column="ptime" property="ptime"/>
	<result column="istpalarm" property="istpalarm"/>
	<result column="ischarge" property="ischarge"/>
	<collection property="tissue" resultMap="Tissue"/>
	<collection property="tpmember" resultMap="Tpmember"/>
</resultMap>
<resultMap type="kr.or.scoop.dto.Tpmember" id="Tpmember">
	<result column="tseq" property="tseq"/>
	<result column="email" property="email"/>
	<result column="pjuserrank" property="pjuserrank"/>
	<result column="pname" property="pname"/>
</resultMap>
<select id="detailPJT" parameterType="kr.or.scoop.dto.TeamPjt" resultMap="TeamPjt">
	SELECT T.TSEQ ,T.pname,T.pcontent ,S.TISEQ, S.tititle, S.TICONTENT, S.TIDATE FROM TEAMPJT T 
	JOIN TISSUE S ON T.TSEQ = S.TSEQ WHERE T.TSEQ = #{TSEQ}
</select>
<select id="getPJT" parameterType="kr.or.scoop.dto.Tpmember" resultMap="Tpmember">
		select m.email, m.TSEQ, t.pname from tpmember m join teampjt t on m.tseq = t.tseq where m.email = #{email}
</select>
</mapper>