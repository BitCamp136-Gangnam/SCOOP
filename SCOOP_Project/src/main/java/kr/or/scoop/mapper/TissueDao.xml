<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.scoop.dao.TissueDao">

<insert id="writeTissue" parameterType="kr.or.scoop.dto.Tissue" >
insert into tissue (tiseq,tseq,email,tititle,ticontent,isprocess, istbook, issee, tidate)
  values (TISEQ_TISSUE_SEQ.NEXTVAL, #{tseq}, #{email}, #{tititle}, #{ticontent}, 0, 0, 0, sysdate,)
</insert>
<resultMap type="kr.or.scoop.dto.Member" id="Member">
	<result column="tseq" property="tseq"/>
	<result column="email" property="email"/>
	<result column="name" property="name"/>
	<result column="pname" property="pname"/>
	<result column="pcontent" property="pcontent"/>
	<result column="ptime" property="ptime"/>
	<result column="istpalarm" property="istpalarm"/>
	<result column="ischarge" property="ischarge"/>
	<collection property="tissue" resultMap="Tissue"/>
	<collection property="tpmember" resultMap="Tpmember"/>
	<collection property="reply" resultMap="Reply"/>
</resultMap>
<resultMap type="kr.or.scoop.dto.Tissue" id="Tissue">
	<result column="tiseq" property="tiseq"/>
	<result column="tseq" property="tseq"/>
	<result column="email" property="email"/>
	<result column="tititle" property="tititle"/>
	<result column="ticontent" property="ticontent"/>
	<result column="tistart" property="tistart"/>
	<result column="tiend" property="tiend"/>
	<result column="isprocess" property="isprocess"/>
	<result column="isbook" property="isbook"/>
	<result column="issee" property="issee"/>
	<result column="tidate" property="tidate"/>
	<result column="tgfilename" property="tgfilename"/>
	<result column="turl" property="turl"/>
</resultMap>
<resultMap type="kr.or.scoop.dto.Reply" id="Reply">
	<result column="replyseq" property="replyseq"/>
	<result column="rcontent" property="rcontent"/>
	<result column="email" property="email"/>
	<result column="rdate" property="rdate"/>
	<result column="tiseq" property="tiseq"/>
</resultMap>
<select id="loadKanban" parameterType="int" resultMap="Tissue">
	select *
	from tissue
	where tseq = #{tseq}
</select>
<select id="teamissueDetail" resultType="kr.or.scoop.dto.Tissue">
	SELECT * FROM tissue WHERE tiseq = #{tiseq, jdbcType=INTEGER}
</select>
<update id="teamSetting">
	update tpmember set pjuserrank=#{param1} where tseq=#{param2} and email=#{param3}
</update>
<update id="kanbanEdit">
	UPDATE tissue 
	SET isprocess=#{param3}
	WHERE tiseq = #{param2} and tseq = #{param1}
</update>
<delete id="banMember">
	delete from tpmember where tseq=#{param1} and email=#{param2}
</delete>

<update id="tiBookMark" parameterType="kr.or.scoop.dto.Tissue">
	update Tissue
	set istbook = #{param2}
	where tiseq=#{param1} and email=#{param3}
</update>
<!-- 북마크 -->
<insert id="addBookMark">
	insert into bookmark(bseq, tiseq, email) 
	values(bseq_bookmark_seq.nextval, #{param1}, #{param2})
</insert>
<delete id="delBookMark">
	delete from bookmark 
	where tiseq=#{param1} and email=#{param2}
</delete>
<insert id="teamComment">
	insert into reply(replyseq, rcontent, email, rdate, tiseq)
  	values(replyseq_reply_seq.nextval, #{param2}, #{param3}, sysdate, #{param1})
</insert>
<select id="teamCommentOk" resultType="kr.or.scoop.dto.Reply">
	select * from reply r join member m on r.email=m.email where tiseq = #{tiseq}
</select>
<insert id="fileInsert">
	insert into filedrive(fdseq, fdcapa, fdname, email, fddate, tseq)
  	values(fdseq_filedrive_seq.nextval, #{param3}, #{param2}, #{param4, jdbcType=VARCHAR}, sysdate, #{param1, jdbcType=INTEGER})
</insert>
<insert id="myFileInsert">
	insert into pfiledrive(pfdseq, pfdcapa, pfdname, email, pfddate)
  	values(pfdseq_pfiledrive_seq.nextval, #{param2}, #{param1}, #{param3, jdbcType=VARCHAR}, sysdate)
</insert>

</mapper>