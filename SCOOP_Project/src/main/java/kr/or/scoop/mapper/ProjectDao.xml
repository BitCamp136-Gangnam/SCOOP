<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.scoop.dao.ProjectDao">
<insert id="insertPJT" parameterType="kr.or.scoop.dto.TeamPjt" >
 insert into Teampjt (tseq,email,pname,pcontent,ptime,istpalarm,ischarge)
  values (tseq_teampjt_seq.nextval,#{email},#{pname},#{pcontent},sysdate,#{istpalarm},#{ischarge})
</insert>
<insert id="insertPJT2">
 insert into tpmember (email,tseq,pjuserrank)
  values (#{param1},#{param2},100)
</insert>
<resultMap type="kr.or.scoop.dto.Tissue" id="Tissue">
	<result column="tiseq" property="tiseq"/>
	<result column="tseq" property="tseq"/>
	<result column="email" property="email"/>
	<result column="tititle" property="tititle"/>
	<result column="ticontent" property="ticontent"/>
	<result column="tistart" property="tistart"/>
	<result column="tiend" property="tiend"/>
	<result column="isprocess" property="isprocess"/>
	<result column="tfilename" property="tfilename"/>
	<result column="tfilesize" property="tfilesize"/>
	<result column="istbook" property="istbook"/>
	<result column="issee" property="issee"/>
	<result column="tidate" property="tidate"/>
	<result column="tgfilename" property="tgfilename"/>
	<result column="tmention" property="tmention"/>
	<result column="turl" property="turl"/>
</resultMap>
<resultMap type="kr.or.scoop.dto.TeamPjt" id="TeamPjt">
	<result column="tseq" property="tseq"/>
	<result column="email" property="email"/>
	<result column="pname" property="pname"/>
	<result column="pcontent" property="pcontent"/>
	<result column="ptime" property="ptime"/>
	<result column="istpalarm" property="istpalarm"/>
	<result column="ischarge" property="ischarge"/>
	<collection property="tissue" resultMap="Tissue"/>
	<collection property="tpmember" resultMap="Tpmember"/>
</resultMap>
<resultMap type="kr.or.scoop.dto.Tpmember" id="Tpmember">
	<result column="tseq" property="tseq"/>
	<result column="email" property="email"/>
	<result column="pjuserrank" property="pjuserrank"/>
	<result column="pname" property="pname"/>
</resultMap>
<resultMap type="kr.or.scoop.dto.ProjectMemberlist" id="ProjectMemberlist">
	<result column="email" property="email"/>
	<result column="name" property="name"/>
	<result column="tseq" property="tseq"/>
	<result column="pjuserrank" property="pjuserrank"/>
</resultMap>
<resultMap type="kr.or.scoop.dto.Member" id="Member">
	<result column="email" property="email"/>
	<result column="pwd" property="pwd"/>
	<result column="name" property="name"/>
	<result column="dname" property="dname"/>
	<result column="drank" property="drank"/>
	<result column="address" property="address"/>
	<result column="idtime" property="idtime"/>
	<result column="loginnum" property="loginnum"/>
	<result column="profile" property="profile"/>
	<collection property="projectMemberlist" resultMap="ProjectMemberlist"/>
</resultMap>
<select id="detailPJT" parameterType="int" resultType="kr.or.scoop.dto.TeamPjt">
	SELECT TSEQ,PNAME,PCONTENT FROM TEAMPJT WHERE TSEQ = #{TSEQ}
</select>
<select id="getPJT" parameterType="kr.or.scoop.dto.Tpmember" resultMap="Tpmember">
		select m.email, m.TSEQ, t.pname from tpmember m join teampjt t on m.tseq = t.tseq where m.email = #{email}
</select>
<select id="getTissue" parameterType="int" resultMap="Tissue">
	SELECT T.TSEQ ,S.TISEQ, S.tititle, S.TICONTENT, S.TIDATE FROM TEAMPJT T 
	JOIN TISSUE S ON T.TSEQ = S.TSEQ WHERE T.TSEQ = #{TSEQ}
</select>
<select id="projectMemberlist" parameterType="kr.or.scoop.dto.ProjectMemberlist" resultMap="ProjectMemberlist">
	select m.email, m.name, t.tseq , t.pjuserrank from member m join tpmember t on m.email = t.email where t.tseq = #{tseq}
</select>
</mapper>